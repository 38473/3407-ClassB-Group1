<!doctype html>

<html lang="en">
 <head>
    <title>My Clean</title>
     <meta charset="utf-8">
     <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="container">
    <header>

       <a href="index.html"><img src="images/myclean.png" alt="My Clean logo" height="70" width="96"></a>

    </header>
    <nav>
         <ul>
            <li><a href="index.html">Home</a ></li>
            <li><a href="about.html">About us</a > </li>
            <li><a href="booking.html" class="active">Booking</a ></li> 
            <li><a href="contact.html">Contact</a ></li>
            <li><a href="payment.html">Payment</a ></li> 
            <li><a href="service.html">Service</a ></li> 
            <li><a href="account.html">Account</a ></li> 
        </ul>
        <div class="auth-buttons">
            <a href="signin.html" class="btn btn-outline">Sign in</a>
            <a href="register.html" class="btn btn-primary">Register</a>
        </div>
    </nav>
   
     <main>
        <div id="intro">
            <form id="bookingForm">
                <h2>Service Reservation Form</h2>
                <label for="serviceType">Service Type</label>
                <select id="serviceType" name="serviceType" required>
                <option value="">-- Please select a service type --</option>
                <option value="home_cleaning">Home Cleaning</option>
                <option value="deep_cleaning">Deep Cleaning</option>
                <option value="move_cleaning">Move-In/Move-Out Cleaning</option>
                <option value="office_cleaning">Office & Commercial Cleaning</option>
                <option value="pet_friendly">Pet-Friendly Services</option>
                <option value="package">Custom Packages & Subscriptions</option>
                </select>
              <div class="error" id="serviceTypeError">Please select a service type.</div>

        
                <label for="address">Address</label>
                <input type="text" id="address" name="address" required>
                <div class="error" id="addressError">Please enter your address.</div>

        
                <label for="mobile">Mobile Phone Number</label>
                <input type="tel" id="mobile" name="mobile" placeholder="e.g. 123456" required>
                <div class="error" id="mobileError">Please enter a valid 6-digit phone number.</div>
        
                <label for="date">Service Date</label>
                <input type="date" id="date" name="date" required>
                <div class="error" id="dateError">Please select a service date.</div>
        
                <label for="time">Service Time</label>
                <input type="time" id="time" name="time" required>
                <div class="error" id="timeError">Please select a service time.</div>

                <button type="submit">Submit Reservation</button>
            </form>
        </div>
        
        <!-- Success Modal -->
        <div id="successModal" class="modal hidden">
            <div class="modal-content">
                <h3>Success!</h3>
                <p>Your reservation has been submitted successfully.</p>
                <button onclick="closeSuccessModal()">Close</button>
            </div>
        </div>
        
        <style>
            form {
                background-color: #ffffff;
                padding: 24px;
                border-radius: 8px;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
        
            h2 {
                color: #1f2937;
                margin-bottom: 16px;
            }
        
            label {
                display: block;
                margin-top: 12px;
                font-weight: bold;
            }
        
            input[type="text"],
            input[type="tel"],
            input[type="date"],
            input[type="time"] {
                width: 100%;
                padding: 8px;
                margin-top: 4px;
                border: 1px solid #d1d5db;
                border-radius: 4px;
            }
        
            .error {
                color: red;
                font-size: 12px;
                display: none;
                margin-top: 4px;
            }
        
            button[type="submit"] {
                margin-top: 20px;
                background-color: #3b82f6;
                color: white;
                padding: 10px 20px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
            }
        
            button[type="submit"]:hover {
                background-color: #2563eb;
            }
            select {
            width: 100%;
            padding: 8px;
           margin-top: 4px;
           border: 1px solid #d1d5db;
            border-radius: 4px;
            }

            

        
            /* Modal */
            .modal {
                position: fixed;
                top: 0; left: 0;
                width: 100%; height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
            }
        
            .modal-content {
                background-color: #fff;
                padding: 24px;
                border-radius: 8px;
                text-align: center;
                max-width: 400px;
            }
        
            .modal-content button {
                margin-top: 16px;
                background-color: #3b82f6;
                color: white;
                padding: 8px 16px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
            }
        
            .hidden {
                display: none;
            }
        </style>
        
        <script>
  document.getElementById("bookingForm").addEventListener("submit", async function(event) {
      event.preventDefault(); 
      let isValid = true;

      const serviceType = document.getElementById("serviceType").value;
      if (serviceType === "") {
          document.getElementById("serviceTypeError").style.display = "block";
          isValid = false;
      }

      // 先隐藏所有错误
      document.querySelectorAll(".error").forEach(error => error.style.display = "none");

      const address = document.getElementById("address").value.trim();
      const mobile = document.getElementById("mobile").value.trim();
      const date = document.getElementById("date").value;
      const time = document.getElementById("time").value;

      if (address === "") {
          document.getElementById("addressError").style.display = "block";
          isValid = false;
      }

      const phoneRegex = /^[0-9]{6}$/;
      if (!phoneRegex.test(mobile)) {
          document.getElementById("mobileError").style.display = "block";
          isValid = false;
      }

      if (date === "") {
          document.getElementById("dateError").style.display = "block";
          isValid = false;
      }

      if (time === "") {
          document.getElementById("timeError").style.display = "block";
          isValid = false;
      }

      if (isValid) {
          try {
              const response = await fetch('/api/bookings', {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json'
                  },
                  body: JSON.stringify({
                      serviceType,
                      address,
                      mobile,
                      datetime: date + ' ' + time,
                      userId: 1  // 这里写死了User_ID，后续你可以动态传
                  })
              });

              if (response.ok) {
                  const data = await response.json();
                  console.log('Booking saved with ID:', data.insertId);
                  document.getElementById("successModal").classList.remove("hidden");
                  document.getElementById("bookingForm").reset();
              } else {
                  alert('Failed to save booking.');
              }
          } catch (error) {
              console.error('Error submitting booking:', error);
              alert('Error submitting booking.');
          }
      }
  });

  function closeSuccessModal() {
      document.getElementById("successModal").classList.add("hidden");
      window.location.href = "payment.html";
  }
</script>
            
        
        </div>
        
     </main>
     <footer class="site-footer">
  <div class="footer-container">
    
    <!-- Left Column: Logo & Social Icons -->
    <div class="footer-brand">
      <img src="images/myclean.png" alt="Impureclean Logo" class="footer-logo" />
      <div class="social-icons">
        <a href=" "><img src="images/x-icon.jpg" alt="X/Twitter"></a >
        <a href="#"><img src="images/instagram-icon.jpg" alt="Instagram"></a >
        <a href="#"><img src="images/youtube-icon.jpg" alt="YouTube"></a >
        <a href="#"><img src="images/linkedin-icon.jpg" alt="LinkedIn"></a >
      </div>
    </div>

    <!-- Center Columns: Links -->
    <div class="footer-links">
      <div class="footer-column">
        <h4>Use cases</h4>
        <ul>
          <li><a href="#">Home Cleaning</a ></li>
          <li><a href="#">Deep Cleaning</a ></li>
          <li><a href="#">Move-In/Move-Out Cleaning</a ></li>
          <li><a href="#">Office & Commercial Cleaning</a ></li>
          <li><a href="#">Pet-Friendly Services</a ></li>
          <li><a href="#">Eco-Friendly Cleaning</a ></li>
          <li><a href="#">Subscription Plans</a ></li>
        </ul>
      </div>

      <div class="footer-column">
        <h4>Explore</h4>
        <ul>
          <li><a href="#">Booking Process</a ></li>
          <li><a href="#">Smart Chat (Bot & Human)</a ></li>
          <li><a href="#">Real-Time Cleaner Tracking</a ></li>
          <li><a href="#">Pricing & Packages</a ></li>
          <li><a href="#">Customer Reviews</a ></li>
          <li><a href="#">Multi-language Support</a ></li>
          <li><a href="#">Service Recommendations</a ></li>
        </ul>
      </div>

      <div class="footer-column">
        <h4>Resources</h4>
        <ul>
          <li><a href="#">How-To Guides</a ></li>
          <li><a href="#">FAQ</a ></li>
          <li><a href="#">Customer Support</a ></li>
          <li><a href="#">Cleaning Tips & Articles</a ></li>
          <li><a href="#">Terms & Policies</a ></li>
          <li><a href="#">Invoices & Billing</a ></li>
          <li><a href="#">Feedback & Reporting</a ></li>
        </ul>
      </div>
    </div>

  </div>
</footer>
    </div>
</body>
</html>
